tpoints <- structure(list(x = c(
  0.532095, 0.189043, 0.550977, 0.00397384, 
  0.89423, 0.0730728, 0.64018, 0.389914, 0.046918, 0.820327, 0.166575, 
  0.587999, 0.184717, 0.264707, 0.564959, 0.986991, 0.214221, 0.997171, 
  0.233578, 0.209772, 0.631619, 0.441601, 0.246242, 0.243191, 0.129101, 
  0.808454, 0.23591, 0.841259, 0.825533, 0.780973, 0.492706, 0.0641069, 
  0.711451, 0.532239, 0.264527, 0.984485, 0.890788, 0.81489, 0.656357, 
  0.161836, 0.789622, 0.00529994, 0.751558, 0.315169, 0.0675723, 
  0.144209, 0.755242, 0.0258396, 0.00905612, 0.0917369, 0.000120247, 
  0.599014, 0.0209242, 0.402961, 0.536965, 0.791622, 0.0492686, 
  0.321031, 0.45994, 0.306635, 0.290264, 0.117081, 0.663268, 0.25703, 
  0.138396, 0.37325, 0.792062, 0.761925, 0.498106, 0.0791993, 0.389481, 
  0.909555, 0.78771, 0.87391, 0.914291, 0.126212, 0.962689, 0.662097, 
  0.514842, 0.573771, 0.541641, 0.880047, 0.854456, 0.882323, 0.0835167, 
  0.868329, 0.211671, 0.169315, 0.116072, 0.900911, 0.889781, 0.209244, 
  0.0556217, 0.787673, 0.327654, 0.571657, 0.519674, 0.0206049, 
  0.00635056, 0.414254
), 
y = c(
  0.894141, 0.613426, 0.415724, 0.60576, 
  0.666812, 0.740658, 0.926186, 0.553149, 0.172275, 0.578957, 0.597895, 
  0.824301, 0.0608049, 0.661072, 0.824897, 0.654621, 0.611877, 
  0.807318, 0.380796, 0.585171, 0.418295, 0.474479, 0.196578, 0.428592, 
  0.460463, 0.240363, 0.362678, 0.0182264, 0.867529, 0.282859, 
  0.0717757, 0.0241644, 0.621806, 0.872561, 0.947361, 0.373498, 
  0.0900603, 0.765458, 0.383494, 0.878997, 0.367808, 0.694075, 
  0.0541492, 0.989785, 0.642346, 0.130059, 0.723929, 0.306045, 
  0.544864, 0.0311395, 0.760615, 0.406906, 0.0676926, 0.743223, 
  0.776167, 0.4288, 0.546021, 0.883358, 0.0493888, 0.920045, 0.480864, 
  0.709596, 0.827229, 0.908703, 0.712536, 0.578061, 0.598336, 0.679885, 
  0.0823257, 0.879007, 0.161374, 0.33623, 0.527877, 0.282804, 0.579771, 
  0.635836, 0.412397, 0.205412, 0.35217, 0.571652, 0.302552, 0.447681, 
  0.455932, 0.00625933, 0.817145, 0.54442, 0.598359, 0.4421, 0.753312, 
  0.0493624, 0.970528, 0.783234, 0.973298, 0.0775736, 0.267293, 
  0.956988, 0.443726, 0.472568, 0.409455, 0.229849
)
), class = "data.frame", row.names = c(NA, -100L))


delaunay_ref <- structure(
  list(
    v1 = c(32L, 59L, 50L, 28L, 13L, 59L, 94L, 31L, 
           28L, 53L, 94L, 50L, 69L, 59L, 53L, 13L, 9L, 71L, 46L, 23L, 69L, 
           78L, 26L, 100L, 78L, 23L, 95L, 74L, 78L, 81L, 100L, 30L, 27L, 
           9L, 100L, 36L, 48L, 36L, 41L, 81L, 39L, 48L, 41L, 52L, 79L, 39L, 
           3L, 52L, 72L, 95L, 27L, 79L, 48L, 41L, 82L, 41L, 88L, 56L, 36L, 
           48L, 99L, 39L, 22L, 95L, 24L, 98L, 61L, 61L, 53L, 61L, 21L, 73L, 
           86L, 49L, 57L, 73L, 61L, 3L, 21L, 97L, 80L, 88L, 10L, 75L, 20L, 
           75L, 25L, 61L, 11L, 73L, 22L, 57L, 11L, 2L, 4L, 2L, 21L, 33L, 
           80L, 57L, 10L, 4L, 45L, 20L, 8L, 87L, 99L, 14L, 76L, 14L, 16L, 
           10L, 33L, 5L, 42L, 67L, 62L, 45L, 65L, 68L, 2L, 45L, 66L, 42L, 
           65L, 89L, 14L, 16L, 6L, 33L, 47L, 38L, 54L, 51L, 92L, 54L, 55L, 
           89L, 85L, 5L, 15L, 33L, 55L, 12L, 51L, 92L, 38L, 85L, 55L, 85L, 
           92L, 63L, 70L, 29L, 64L, 63L, 54L, 34L, 40L, 51L, 64L, 12L, 1L, 
           1L, 35L, 96L, 58L, 91L, 58L, 7L, 35L, 40L, 93L, 53L, 51L, 44L, 
           44L, 93L, 7L, 44L, 93L, 99L, 96L, 4L, 18L, 44L, 99L), 
    v2 = c(59L, 
           28L, 59L, 90L, 59L, 43L, 28L, 43L, 37L, 50L, 37L, 46L, 43L, 69L, 
           46L, 71L, 46L, 69L, 23L, 71L, 78L, 94L, 37L, 69L, 26L, 95L, 100L, 
           37L, 30L, 78L, 81L, 74L, 95L, 23L, 79L, 74L, 23L, 37L, 74L, 39L, 
           30L, 27L, 72L, 39L, 52L, 41L, 52L, 21L, 77L, 79L, 88L, 97L, 88L, 
           82L, 77L, 83L, 24L, 83L, 90L, 25L, 25L, 56L, 97L, 22L, 27L, 25L, 
           27L, 95L, 48L, 22L, 56L, 83L, 82L, 57L, 25L, 86L, 8L, 21L, 73L, 
           21L, 21L, 61L, 86L, 82L, 61L, 77L, 20L, 66L, 20L, 67L, 80L, 11L, 
           2L, 87L, 57L, 17L, 33L, 67L, 33L, 76L, 75L, 45L, 76L, 66L, 80L, 
           66L, 49L, 87L, 2L, 66L, 77L, 5L, 68L, 16L, 45L, 5L, 65L, 62L, 
           2L, 5L, 14L, 6L, 80L, 6L, 14L, 65L, 54L, 36L, 89L, 47L, 38L, 
           5L, 80L, 6L, 14L, 55L, 33L, 92L, 89L, 18L, 12L, 63L, 63L, 63L, 
           85L, 54L, 18L, 92L, 34L, 40L, 58L, 38L, 40L, 18L, 58L, 29L, 34L, 
           12L, 64L, 70L, 60L, 7L, 12L, 7L, 60L, 7L, 34L, 18L, 1L, 29L, 
           44L, 35L, 40L, 99L, 93L, 58L, 1L, 35L, 91L, 96L, 44L, 4L, 91L, 
           51L, 36L, 91L, 51L), 
    v3 = c(84L, 84L, 32L, 84L, 50L, 28L, 43L, 
           59L, 90L, 32L, 28L, 13L, 31L, 31L, 50L, 59L, 53L, 59L, 13L, 13L, 
           43L, 43L, 94L, 71L, 94L, 71L, 71L, 26L, 26L, 69L, 69L, 26L, 23L, 
           46L, 81L, 72L, 9L, 74L, 30L, 78L, 78L, 23L, 74L, 81L, 81L, 30L, 
           79L, 39L, 36L, 100L, 19L, 3L, 27L, 72L, 72L, 82L, 19L, 41L, 37L, 
           88L, 48L, 41L, 79L, 79L, 19L, 99L, 24L, 27L, 9L, 95L, 39L, 56L, 
           83L, 98L, 98L, 83L, 22L, 52L, 56L, 3L, 97L, 24L, 73L, 86L, 88L, 
           82L, 88L, 8L, 25L, 10L, 97L, 25L, 20L, 20L, 49L, 87L, 73L, 73L, 
           21L, 11L, 86L, 57L, 57L, 61L, 22L, 20L, 98L, 17L, 11L, 87L, 75L, 
           75L, 67L, 75L, 4L, 10L, 76L, 76L, 76L, 67L, 17L, 62L, 8L, 45L, 
           2L, 62L, 66L, 77L, 62L, 68L, 68L, 68L, 66L, 42L, 65L, 80L, 80L, 
           65L, 6L, 16L, 55L, 47L, 33L, 55L, 6L, 14L, 5L, 89L, 15L, 92L, 
           54L, 47L, 85L, 38L, 92L, 38L, 55L, 15L, 92L, 85L, 58L, 63L, 34L, 
           12L, 64L, 1L, 54L, 29L, 34L, 63L, 60L, 64L, 70L, 48L, 70L, 60L, 
           58L, 40L, 29L, 1L, 35L, 49L, 7L, 42L, 16L, 96L, 4L)), 
  row.names = c(NA, -187L), class = c("tbl_df", "tbl", "data.frame"))


test_that("Delaunay works", {
  
  del <- delaunay(tpoints$x, tpoints$y) 
  
  expect_equal(names(del$tris), c('v1', 'v2', 'v3'))
  
  del <- rvoronoi:::normalise_del(del$tris)
  ref <- rvoronoi:::normalise_del(delaunay_ref)
  
  expect_identical(del, ref)
})

